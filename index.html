<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Graph : A Javascript/jQuery/HTML5 x-y graph library." />
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/prettify.css">
    <style type="text/css">

    /* Pretty printing styles. Used with prettify.js. */
    /* Vim sunburst theme by David Leibovic */

    pre .str, code .str { color: #65B042; } /* string  - green */
    pre .kwd, code .kwd { color: #E28964; } /* keyword - dark pink */
    pre .com, code .com { color: #AEAEAE; font-style: italic; } /* comment - gray */
    pre .typ, code .typ { color: #89bdff; } /* type - light blue */
    pre .lit, code .lit { color: #3387CC; } /* literal - blue */
    pre .pun, code .pun { color: #fff; } /* punctuation - white */
    pre .pln, code .pln { color: #fff; } /* plaintext - white */
    pre .tag, code .tag { color: #89bdff; } /* html/xml tag    - light blue */
    pre .atn, code .atn { color: #bdb76b; } /* html/xml attribute name  - khaki */
    pre .atv, code .atv { color: #65B042; } /* html/xml attribute value - green */
    pre .dec, code .dec { color: #3387CC; } /* decimal - blue */

    pre.prettyprint, code.prettyprint {
      background-color: #111111;
      -moz-border-radius: 8px;
      -webkit-border-radius: 8px;
      -o-border-radius: 8px;
      -ms-border-radius: 8px;
      -khtml-border-radius: 8px;
      border-radius: 8px;
    }

    pre.prettyprint {
      width: 95%;
      margin: 1em auto;
      padding: 1em;
      white-space: pre-wrap;
    }

    /* Specify class=linenums on a pre to get line numbering */
    ol.linenums { margin-top: 0; margin-bottom: 0; color: #AEAEAE; } /* IE indents via margin-left */
    li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8 { list-style-type: none }
    /* Alternate shading for lines */
    li.L1,li.L3,li.L5,li.L7,li.L9 { }

    @media print {
      pre .str, code .str { color: #060; }
      pre .kwd, code .kwd { color: #006; font-weight: bold; }
      pre .com, code .com { color: #600; font-style: italic; }
      pre .typ, code .typ { color: #404; font-weight: bold; }
      pre .lit, code .lit { color: #044; }
      pre .pun, code .pun { color: #440; }
      pre .pln, code .pln { color: #000; }
      pre .tag, code .tag { color: #006; font-weight: bold; }
      pre .atn, code .atn { color: #404; }
      pre .atv, code .atv { color: #060; }
    }

    .graph { width: 700px; height: 300px }

  </style>
    <title>Graph</title>
	<!--[if lt IE 9]><script src="http://lcogt.net/virtualsky/embed/excanvas.js" type="text/javascript"></script><![endif]-->
	<script language="javascript" type="text/javascript" src="javascripts/prettify.js"></script>
	<script language="javascript" type="text/javascript" src="javascripts/jquery.min.js"></script>
	<script language="javascript" type="text/javascript" src="javascripts/jquery.graph.js"></script>
	<script type="text/javascript">
	$(document).ready(function(){
		
		// Set up the prettification of code blocks
		prettyPrint();
		
		options = {
			series: {
				lines: { show: false },
				points: { show: true },
				shadowSize: 0
			},
			xaxis:{ label:'Time (HJD)' },
			yaxis: { label: 'Delta (mag)' },
			grid: { hoverable: true, clickable: true }
		};
	
		$.ajax({
			dataType: "json", 
			url: "OB110462.json",
			success: function(obs){
				data = new Array(obs.observatories.length);
		
				var minjd,maxjd;
				
				counter = 0;
				for(var i = 0; i < obs.observatories.length ; i++){
					o = obs.observatories[i];
					data[i] = [];
					err = (typeof o.err=="object") ? true : false;
					gstamp = (typeof o.gstamp=="object") ? true : false;
					for(var j = 0; j < o.dmag.length ; j++){
						if(!minjd || o.hjd[j] < minjd) minjd = o.hjd[j];
						if(!maxjd || o.hjd[j] > maxjd) maxjd = o.hjd[j];
						a = { x: o.hjd[j], y: o.dmag[j] };
						if(err) a.err = o.err[j];
						if(gstamp && typeof o.gstamp[j]=="string") a.gstamp = o.gstamp[j];
						data[i].push(a);
						counter++;
					}
				}
					
				options = {
					xaxis:{ label:'Time (HJD)' },
					yaxis: { label: 'Delta (mag)' },
					grid: { hoverable: true, clickable: true }
				};
	
		
				model = new Array(obs.model.xval.length);
				for(var i=0 ; i<obs.model.xval.length ; i++){
					model[i] = ({x:obs.model.xval[i],y:obs.model.yval[i]})
				}
				var dataset = [];
				for(var d=0 ; d < data.length ; d++){
					dataset.push({ data: data[d], points :{show:true, radius: 1.5}, title:'Series '+(obs.observatories[d].obs_id), color: obs.observatories[d].html_col, lines: { show: false }, clickable: true, hoverable:true, hover:{ text:'{{xlabel}}: {{x}}<br />{{ylabel}}: {{y}}<br />Uncertainty: {{err}}',before:'{{title}}<br />'},css:{'font-size':'0.8em','background-color':obs.observatories[d].html_col} });
				}
				dataset.push({data:model,color: "#999999",points:{show:false},lines:{show:true,width:2}, clickable: false, hoverable:false });
		
				options.xaxis = {log: false,label:'MJD (days)',fit:true};
				options.yaxis.log = false;

				graph = $.graph('lightcurve', dataset, options);
			}
		});
	
		n = 200;
		series = new Array(n);
		for(var i=0 ; i<n ; i++) series[i] = {x:14+i,y:Math.pow(i,2/3)+2, i:i};
		options.xaxis = {log: false, label:''};
		options.yaxis = {log: true, label:'Power'};
		graph2 = $.graph('lightcurve2', {
			data: series,
			color: "#9944ff",
			points: { show: false, radius: 1.5 },
			lines: { show:true,width:4}
		}, options);
	
		series2 = [{x:1,y:0.999,err:0.022,note:'Note 1'},{x:2,y:1.002,err:0.012,note:'A second note'},{x:3,y:0.999,err:0.012,note:'This point has a note'},{x:4,y:0.997,err:0.013},{x:5,y:0.999,err:0.03},{x:6,y:0.997,err:0.013},{x:7,y:0.99,err:0.022},{x:8,y:0.995,err:0.017},{x:9,y:0.996,err:0.009},{x:10,y:1.001,err:0.404},{x:11,y:1.004,err:0.021},{x:12,y:0.995,err:0.012},{x:13,y:0.997,err:0.022},{x:14,y:0.993,err:0.03},{x:15,y:0.994,err:0.016},{x:16,y:0.997,err:0.02},{x:17,y:0.993,err:0.026},{x:18,y:0.999,err:0.022},{x:19,y:0.993,err:0.015},{x:20,y:1.002,err:0.011},{x:21,y:1,err:0.033},{x:22,y:0.995,err:0.02},{x:23,y:0.997,err:0.011},{x:24,y:0.995,err:0.022},{x:25,y:0.999,err:0.015},{x:26,y:0.997,err:0.018},{x:27,y:0.996,err:0.008},{x:28,y:0.988,err:0.021},{x:29,y:0.992,err:0.015},{x:30,y:0.987,err:0.03},{x:31,y:0.994,err:0.025},{x:32,y:0.99,err:0.022},{x:33,y:0.985,err:0.024},{x:34,y:0.986,err:0.011},{x:35,y:0.985,err:0.014},{x:36,y:0.963,err:0.045,note:'This point is low due to an error'},{x:37,y:0.969,err:0.047},{x:38,y:0.974,err:0.032},{x:39,y:0.975,err:0.014},{x:40,y:0.99,err:0.082},{x:41,y:0.976,err:0.019},{x:42,y:0.985,err:0.012},{x:43,y:0.976,err:0.017},{x:44,y:0.974,err:0.025},{x:45,y:0.982,err:0.007},{x:46,y:0.986,err:0.025},{x:47,y:0.978,err:0.018},{x:48,y:0.976,err:0.014},{x:49,y:0.974,err:0.027},{x:50,y:0.979,err:0.014},{x:51,y:0.978,err:0.019},{x:52,y:0.976,err:0.021},{x:53,y:0.978,err:0.016},{x:54,y:0.974,err:0.028},{x:55,y:0.976,err:0.019},{x:56,y:0.974,err:0.023},{x:57,y:0.977,err:0.025},{x:58,y:0.98,err:0.012},{x:59,y:0.975,err:0.012},{x:60,y:0.977,err:0.013},{x:61,y:0.986,err:0.022},{x:62,y:0.974,err:0.021},{x:63,y:0.972,err:0.023},{x:64,y:0.98,err:0.01},{x:65,y:0.98,err:0.024},{x:66,y:0.976,err:0.02},{x:67,y:0.974,err:0.036},{x:68,y:0.983,err:0.022},{x:69,y:0.975,err:0.021},{x:70,y:0.982,err:0.015},{x:71,y:0.981,err:0.029},{x:72,y:0.982,err:0.018},{x:73,y:0.98,err:0.019},{x:74,y:0.976,err:0.034},{x:75,y:0.985,err:0.012},{x:76,y:0.977,err:0.047},{x:77,y:0.985,err:0.016},{x:78,y:0.993,err:0.01},{x:79,y:0.987,err:0.027},{x:80,y:0.992,err:0.016},{x:81,y:0.995,err:0.022},{x:82,y:0.99,err:0.023},{x:83,y:0.998,err:0.027},{x:84,y:0.996,err:0.022},{x:85,y:0.993,err:0.02},{x:86,y:0.995,err:0.018},{x:87,y:0.995,err:0.015},{x:88,y:1.001,err:0.031},{x:89,y:1.004,err:0.029},{x:90,y:0.998,err:0.019},{x:91,y:1,err:0.011},{x:92,y:0.993,err:0.012},{x:93,y:0.987,err:0.022},{x:94,y:0.994,err:0.017},{x:95,y:0.978,err:0.038},{x:96,y:1.002,err:0.014},{x:97,y:0.989,err:0.023},{x:98,y:1.003,err:0.022},{x:99,y:0.998,err:0.013},{x:100,y:0.993,err:0.023},{x:101,y:0.994,err:0.013},{x:102,y:1.01,err:0.046},{x:103,y:0.998,err:0.013},{x:104,y:1.007,err:0.037},{x:105,y:0.992,err:0.044},{x:106,y:1.004,err:0.031},{x:107,y:0.992,err:0.013},{x:108,y:1,err:0.01},{x:109,y:1.008,err:0.025}];

		graph3 = $.graph('lightcurve3', {
			data: series2,
			color: "#dd9901",
			points: {show:true,radius:1.5},
			lines: {show:false,width:4},
			hoverable:true,
			hover: {
				text: function(e){
					if(typeof e.data.note=="string") return "{{xlabel}}: {{x}}<br />{{ylabel}}: {{y}}<br />Error: {{err}}<br />Note: {{ note }}";
					else return "{{xlabel}}: {{x}}<br />{{ylabel}}: {{y}}<br />Error: {{err}}";
				}
			}
		}, {xaxis:{log:false,label:'t'},grid:{show:false,background:'rgb(255,255,255)'}});

		graph4 = $.graph('lightcurve4', {data:series2,color: "#44bb44",points:{show:true,radius:1.5},lines:{show:true,width:2},hoverable:true}, {xaxis:{log:false,label:'t'},grid:{show:true,color:'rgb(255,0,0)'}});
	
	});
	</script>
  </head>
  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/slowe/graph">Fork Me on GitHub</a>

          <h1 id="project_title">Graph</h1>
          <h2 id="project_tagline">An HTML5 x-y graph library</h2>
          <p style="float:left;color:white;color:rgba(255,255,255,0.5);margin-top:-1em;">Last updated: 11 April 2012</p>

          <section id="downloads">
            <a class="zip_download_link" href="https://github.com/slowe/graph/zipball/master">Download this project as a .zip file</a>
            <a class="tar_download_link" href="https://github.com/slowe/graph/tarball/master">Download this project as a tar.gz file</a>
          </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">

		<div id="lightcurve" style="width:100%;height:350px;margin-bottom:10px;"></div>
		<div style="text-align:center;font-size:0.8em;color:#999;padding-left:25px; padding-right:25px;">This plot represents observations of a gravitational <a href="http://lcogt.net/book-page/gravitational-microlensing">microlensing</a> event. Each data series shows the variation in brightness of the target star as measured by different telescopes in the <a href="http://robonet.lcogt.net/">ROBONET</a> collaboration. See <a href="#examples">more examples</a></div>

		<h3>Overview</h3>
		<p>There are many good Javascript/HTML5 graphing libraries already in existence e.g. <a href="https://github.com/flot/flot">Flot</a>, <a href="http://mbostock.github.com/d3/">D3</a> and <a href="https://github.com/alexyoung/ico">Ico</a>. However they don't easily make the simple x-y data graphs often used in scientific environments. This is an attempt to write a small jQuery plugin that could deal with large amounts of data, error bars, logarithmic axes, page resizing, and other features. This is still under active development.</p>

		<h3>Features (so far...)</h3>
		<ul>
			<li>Draws x-y graphs.</li>
			<li>Can include error bars.</li>
			<li>Both axes (or just one) can be logarithmic.</li>
			<li>Automatically chooses "nice" gridline spacings.</li>
			<li>Multiple data series can be drawn with the following options:
				<ul>
					<li>Colour</li>
					<li>Points shown or hidden</li>
					<li>Points can be joined with lines</li>
					<li>Line widths can be defined</li>
					<li>Main plot area background colour can be set</li>
					<li>Hover text on data points which can include custom text with replacable elements</li>
				</ul>
			</li>
			<li>The graph should resize if the graph holder resizes (useful if you have adaptive CSS styling).</li>
			<li>On newer versions of FF/Safari/Chrome the graph can be made full-screen by double clicking.</li>
			<li>The graph inherits the font size/family from its parent elemet in the DOM (i.e. you can set it in the CSS).</li>
			<li>Can zoom in (click/drag) and zoom out (click).</li>
		</ul>

		<h3>Dependencies and Limitations</h3>
		<p>For this library to work it has two dependencies:</p>

		<ul>
			<li><a href="http://jquery.com/">jquery.js</a> - your site may already use this excellent library</li>
			<li><a href="http://code.google.com/p/explorercanvas/">excanvas.js</a> - this is used to allow canvas support on Internet Explorer (41.6 kB). If only it wasn't needed.</li>
		</ul>
		
		<p>Some features (e.g. fullscreen) are experimental and will only work in the latest versions of modern browsers.</p>

		<h3>Usage</h3>
		<p>You need to include the appropriate Javascript files:</p>

		<pre class="prettyprint lang-js"><code>&lt;script src="jquery.js"&gt;&lt;/script&gt;
&lt;!--[if IE]&gt;&lt;script src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;
&lt;script src="jquery.graph.js"&gt;&lt;/script&gt;</code></pre>

		<p>Following those you'll need:</p>

		<pre class="prettyprint lang-js"><code>$(document).ready(function(){
  // First we'll build an array of data sets
  var dataset = [];

  // Add a data set
  dataset.push({
    // Data in the form [{x:x1,y:y1,err:err1},...{x:xn,y:yn,err:errn}]
    data: [{x:0,y:0.1},{x:1,y:0.2},{x:2,y:0.1},{x:3,y:0.25}],
    color: '#FFBBDD',
    points: { show: true },
    lines: { show: true ,width: 2 },
    clickable: false,
    hoverable: false,
    // Modify the default hover text with replacements
    hover: {
    	text: '{{xlabel}}: {{x}}&lt;br /&gt;{{ylabel}}: {{y}}&lt;br /&gt;Error: {{err}}',
    	before: '{{title}}&lt;br /&gt;'
    },
    css: {
      'font-size': '0.8em',
      'background-color': obs.observatories[d].html_col
    }
  });

  // Define some options
  options = {
    xaxis:{ label:'Time (HJD)' },
    yaxis: { label: 'Delta (mag)' },
    grid: { hoverable: true, clickable: true }
  };

  // Attach to the DOM element with the ID 'lightcurve'
  graph = $.graph('lightcurve', dataset, options);
});</code></pre>

		<h3 id="examples">Examples</h3>
		<p>The top of the page is a live example that constructs the data series from a <code>JSON</code> file. Below are some more. Try making the browser window narrow to see how the graphs resize.</p>

		<h4>Example 2</h4>
		<div id="lightcurve2" style="height:250px;font-size:0.7em;font-family:Courier New;margin-bottom:16px;"></div>
		<pre class="prettyprint lang-js"><code>// Create a fake data series
n = 200;
series = new Array(n);
for(var i=0 ; i < n ; i++){
	series[i] = { x: 14+i, y: Math.pow(i,2/3)+2 };
}

// Define some options
options.xaxis = { label: '' };
options.yaxis = { log: true, label: 'Power' };

dataset = {
	data:series,
	color: "#9944ff",
	points: {
		show: false,
		radius: 1.5
	},
	lines: {
		show: true,
		width: 4
	}
}

// Create the graph
graph2 = $.graph('lightcurve2', dataset, options);
</code></pre>

		<h4>Example 3</h4>
		<div style="padding:16px;background-color:#ddd;">
			<div id="lightcurve3" style="height:350px;font-family:Arial,sans-serif;"></div>
			<br />This is some normal text in the same bounding box to show the background colour. This plot actually shows the dip in brightness of a star caused by a transiting planet. The depth of the dip can be used to estimate the relative size of the planet and star. Some points, such as the first three, show how you can write a function to customize the content of the hover box.
		</div>
		<pre class="prettyprint lang-js"><code>series2 = [{x:1,y:0.999,err:0.022},{x:2,y:1.002,err:0.012}...];

graph3 = $.graph('lightcurve3', {
	data: series2,
	color: "#dd9901",
	points: { show: true, radius: 1.5 },
	lines: { show: false, width: 4 },
	hoverable: true,
	hover: {
		text: function(e){
			if(typeof e.data.note=="string") return "{{xlabel}}: {{x}}&lt;br /&gt;{{ylabel}}: {{y}}&lt;br /&gt;Error: {{err}}&lt;br /&gt;Note: {{ note }}";
			else return "{{xlabel}}: {{x}}&lt;br /&gt;{{ylabel}}: {{y}}&lt;br /&gt;Error: {{err}}";
		}
	}
},{
	xaxis: { log: false, label: 't' },
	grid: { show: false, background: 'rgb(255,255,255)' }
});</code></pre>

		<h4>Example 4</h4>
		<div id="lightcurve4" style="height:350px;margin-top:16px;"></div>
		<pre class="prettyprint lang-js"><code>series2 = [{x:1,y:0.999,err:0.022},{x:2,y:1.002,err:0.012}...];

graph4 = $.graph('lightcurve4', {
	data: series2,
	color: "#44bb44",
	points: { show: true, radius: 1.5 },
	lines: { show: true, width: 2 },
	hoverable: true
},{
	xaxis: { log: false, label: 't' },
	grid: { show: true, color:'rgb(255,0,0)' }
});</code></pre>

		<h3>Author</h3>
		<p>Stuart Lowe works for the <a href="http://lcogt.net/">Las Cumbres Observatory Global Telescope</a>. LCOGT is a private operating foundation, building a global network of telescopes for professional research and citizen investigations.</p>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Graph maintained by <a href="https://github.com/slowe">slowe</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
